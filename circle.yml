machine:
  ruby:
    version: 2.4.1
  node:
    version: 8.9.4
  services:
    - redis
  environment:
    PATH: "${PATH}:${HOME}/${CIRCLE_PROJECT_REPONAME}/node_modules/.bin"
general:
  artifacts:
    - "tmp/capybara"
dependencies:
  override:
    - yarn
  cache_directories:
    - ~/.cache/yarn
  pre:
    - curl -s https://raw.githubusercontent.com/chronogolf/circleci-google-chrome/master/use_chrome_stable_version.sh | bash
  post:
    - bundle exec rake hydra:test_server:
        background: true
    - bin/jetty_wait
test:
  override:
    - yarn test
notify:
  webhooks:
#    - url: https://coveralls.io/webhook?repo_token=99vvdztEbEsxv5JiHmFK6tJQPX5fSEeDM
